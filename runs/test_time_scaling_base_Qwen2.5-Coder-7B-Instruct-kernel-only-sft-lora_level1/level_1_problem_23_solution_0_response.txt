Please provide the entire implementation including any necessary imports and definitions. Ensure that the `get_inputs` and `get_init_inputs` functions remain unchanged from the original. Your solution should aim to achieve significant performance improvements over the original PyTorch implementation. 

**Note:** Feel free to use any optimization techniques such as algorithmic changes, operator fusion, or custom CUDA kernels. The goal is to maximize performance while maintaining correctness.