Note: This task requires knowledge of both PyTorch and CUDA programming. Make sure to handle memory allocation and deallocation correctly within the CUDA kernels. Also, ensure thread safety when accessing shared resources.