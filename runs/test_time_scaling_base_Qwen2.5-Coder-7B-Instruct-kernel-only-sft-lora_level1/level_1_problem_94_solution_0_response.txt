The resulting code should be able to run on a GPU without any issues. If the original code does not utilize GPUs at all, you must ensure that the optimized version uses them. If the original code utilizes GPUs but not optimally, you must optimize it further. 

Please do not change the function signatures or names of the provided code snippets.
```