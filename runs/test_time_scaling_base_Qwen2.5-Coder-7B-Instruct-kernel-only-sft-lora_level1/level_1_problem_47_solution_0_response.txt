Please provide a detailed explanation of the optimizations made, including any algorithmic changes, operator fusion, or custom CUDA kernels used.