## Constraints:

- Use `torch.utils.cpp_extension.load_inline` to compile the CUDA kernels.
- The CUDA kernels should be efficient and well-optimized.
- The code should be self-contained and clear.
- Avoid using external libraries other than those imported at the beginning of the script.
- Ensure that the functionality of the original model is preserved.
- Optimize both memory usage and computation time.
- If necessary, you can use PyTorch's built-in operations within the CUDA kernel itself.
- Consider algorithmic optimizations such as parallelizing the reduction process.
- The solution should be scalable to larger batch sizes and dimensions.
- Provide a brief explanation of the optimization techniques used.
```