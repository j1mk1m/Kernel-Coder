    Your code should include comments explaining the reasoning behind replacing certain operations with custom CUDA kernels. You should also explain any optimizations or algorithmic changes made to improve performance.
```