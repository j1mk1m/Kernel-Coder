Please note that the goal is to optimize performance, so feel free to use any CUDA features such as shared memory, coalesced memory access, etc. Also, you can use any PyTorch C++ extensions or other libraries if necessary.