Make sure that the `get_inputs` and `get_init_inputs` functions remain unchanged from the original code.

Here's a hint on how to approach this task:

- Consider replacing the convolution operation with a custom CUDA kernel, especially since it involves a large number of operations per pixel.
- Investigate whether there is a way to optimize the scaling operation using a custom CUDA kernel.
- Explore opportunities to fuse the minimum operation with another operation to reduce the number of passes through the data.
- Remember to handle memory allocation and deallocation properly within your custom CUDA kernels.

```markdown
```python
# Your optimized code here
```python
```

















