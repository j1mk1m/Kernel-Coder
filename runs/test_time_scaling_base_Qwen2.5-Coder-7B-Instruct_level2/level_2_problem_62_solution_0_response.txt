    Note: Feel free to optimize any part of the architecture, including but not limited to, replacing PyTorch operators with custom CUDA kernels, fusing multiple operations into one kernel, or changing algorithms to improve performance. Your goal is to achieve the highest possible performance while maintaining correctness.