Make sure your code includes the necessary imports, defines any custom CUDA kernels, and compiles them using `load_inline`. Your final architecture should be fully compatible with PyTorch's autograd system so it can be used in training loops seamlessly. Make sure to handle all necessary data types and memory transfers between CPU and GPU.