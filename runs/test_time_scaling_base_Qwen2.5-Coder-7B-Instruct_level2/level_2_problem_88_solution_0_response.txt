Please ensure that you provide enough information so that someone else could copy and paste the code directly into their environment and use it.

### Note:

- You can choose any subset of the operations to replace with custom CUDA kernels.
- Feel free to combine multiple operations into a single kernel.
- Consider algorithmic optimizations where applicable (e.g., online softmax).
- Your implementation should be efficient and maintain the correctness of the original model.
```











































