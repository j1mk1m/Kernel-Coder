Your solution should include any necessary imports and definitions of the custom CUDA kernels. You should also provide a detailed explanation of why you chose to optimize certain operations with custom CUDA kernels and how it improves performance.

**Note:** Your implementation must be compatible with PyTorch and should leverage PyTorch's C++ extensions for CUDA. Make sure to handle edge cases such as empty tensors and different data types appropriately.