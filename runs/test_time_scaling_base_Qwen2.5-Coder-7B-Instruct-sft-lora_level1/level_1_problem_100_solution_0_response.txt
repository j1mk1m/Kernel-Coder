The provided code should be completely self-contained. It should contain all necessary imports, definitions, and functions to run without any external dependencies. Ensure that the architecture has been correctly implemented and verified for correctness.