Please provide the complete code for the optimized architecture, including any necessary imports and setup. Make sure the architecture is fully functional and maintains the same behavior as the original architecture. Your solution should be optimized for performance using custom CUDA kernels where appropriate.