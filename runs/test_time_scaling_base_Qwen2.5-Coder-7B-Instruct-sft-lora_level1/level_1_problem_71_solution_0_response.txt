Here are the guidelines again:

- You can choose any subset of operations to optimize with custom CUDA kernels.
- Feel free to fuse multiple operations together.
- You can use algorithmic optimizations such as online softmax.
- Your solution should be efficient and maintain readability.
- Ensure that the resulting model (`ModelNew`) has the same functionality as the original model (`Model`).

Please provide the full code for both `Model` and `ModelNew`.