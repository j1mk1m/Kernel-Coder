Please provide detailed explanations of your design choices and any optimizations you made. Your explanation should be clear enough that someone else could understand and implement the same optimization without needing additional context.