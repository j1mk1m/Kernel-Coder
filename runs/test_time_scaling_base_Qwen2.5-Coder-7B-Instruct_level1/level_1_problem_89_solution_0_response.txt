Please note that while optimizing, feel free to use any combination of techniques including but not limited to:

- Operator fusion
- Algorithmic changes (e.g., using more efficient prefix sum algorithms)
- Custom CUDA kernels
- PyTorch's C++ API

Remember to provide the necessary imports at the beginning of the code. Ensure that the new architecture (`ModelNew`) is completely self-contained and does not rely on external files beyond what is provided here.