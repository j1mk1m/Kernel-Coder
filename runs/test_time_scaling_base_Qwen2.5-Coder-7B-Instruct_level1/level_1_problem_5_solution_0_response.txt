Please note that the goal here is to optimize the performance of the model by replacing the existing PyTorch operations with custom CUDA kernels where appropriate. Your solution should demonstrate a clear understanding of both PyTorch and CUDA programming.