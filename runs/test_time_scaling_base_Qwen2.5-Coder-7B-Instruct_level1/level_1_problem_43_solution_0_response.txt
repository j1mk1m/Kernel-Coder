Please note that your solution should be efficient in terms of both memory usage and computation time. Feel free to experiment with different algorithms and optimizations, but ensure that the final implementation is correct and meets the requirements. 

Also, please provide a brief explanation of your choices and any potential trade-offs in your approach.