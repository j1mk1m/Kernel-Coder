Please note that your solution should be efficient in terms of both time complexity and memory usage. If there are any potential bottlenecks or areas for improvement, please comment on them in your answer.
```