The custom CUDA operators should be implemented using PyTorch's C++ API. Make sure to include all necessary headers and link against the appropriate libraries. 

Make sure that the new architecture maintains the same functionality as the original architecture. You can use the provided test code to verify this. 

Please provide the optimized code for ModelNew below.