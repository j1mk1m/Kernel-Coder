Please note that the goal is to optimize performance, so the new implementation should be faster than the original PyTorch version when run on a GPU.