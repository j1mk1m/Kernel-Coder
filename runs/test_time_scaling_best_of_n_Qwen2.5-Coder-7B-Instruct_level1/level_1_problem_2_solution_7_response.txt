Please note that I am looking for a solution where the entire forward pass is accelerated using custom CUDA kernels, not just parts of it. Also, please ensure that the code adheres to best practices and follows PyTorch conventions.
```