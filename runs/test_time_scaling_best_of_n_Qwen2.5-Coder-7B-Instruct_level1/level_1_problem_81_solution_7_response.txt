### Constraints:
- The code must compile without errors.
- The function signatures must remain unchanged.
- The performance should be improved compared to the original implementation.
- Only use custom CUDA kernels for optimization; do not change the model architecture itself.
- Ensure that all operations within the `forward` method are either implemented using PyTorch built-in functions or custom CUDA kernels.