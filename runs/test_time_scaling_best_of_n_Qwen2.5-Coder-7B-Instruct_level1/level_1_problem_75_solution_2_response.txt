Note that you should optimize for both speed and memory usage, but prioritize speed. Feel free to change the function signatures and class names if needed to achieve the optimization goals.