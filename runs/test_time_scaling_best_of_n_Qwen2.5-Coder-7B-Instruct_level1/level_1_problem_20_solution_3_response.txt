Please note that this question is asking for optimization using custom CUDA kernels, not just replacing PyTorch operators with equivalent operations from NumPy or other libraries. Make sure your solution leverages actual GPU acceleration through CUDA.