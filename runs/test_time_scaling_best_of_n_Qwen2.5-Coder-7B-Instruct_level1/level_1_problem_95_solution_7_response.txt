Note: Your implementation should be able to handle large batch sizes efficiently. Consider using techniques such as fused operations, shared memory, and efficient memory access patterns to optimize performance.
```