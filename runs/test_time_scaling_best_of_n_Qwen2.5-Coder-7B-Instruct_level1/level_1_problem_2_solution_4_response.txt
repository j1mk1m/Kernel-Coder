Make sure to include all necessary imports at the top of your code. Make sure to use `load_inline` from `torch.utils.cpp_extension` to compile your CUDA kernels. Include any additional helper functions or classes you need. 

Please provide the final code in a markdown codeblock.
```