Please note that your solution should be efficient in terms of both time and space complexity, and it should leverage CUDA's parallel processing capabilities. Additionally, please ensure that the custom CUDA kernels you create are well-optimized and take full advantage of GPU resources.