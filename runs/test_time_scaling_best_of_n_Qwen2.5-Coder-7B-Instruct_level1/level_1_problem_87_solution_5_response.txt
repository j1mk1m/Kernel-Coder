Please also explain your optimization choices in a comment above each class or method you modify.