Your implementation should include at least one custom CUDA kernel. Feel free to optimize further if you see additional opportunities. Make sure to handle edge cases where possible.