Please ensure the new architecture is still compatible with the `get_inputs` and `get_init_inputs` functions provided.