Please note that the goal here is to optimize performance, so you should focus on replacing operations that can benefit most from custom CUDA kernels. Consider algorithmic optimizations as well. For instance, if there are redundant computations or ways to reduce memory access patterns, those should be considered.