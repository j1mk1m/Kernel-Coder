Please note that you can freely choose which operators to optimize with custom CUDA kernels and how to implement them. Feel free to combine multiple operators or use different algorithms to achieve better performance. Your goal is to optimize the given architecture as much as possible while maintaining its functionality.