Please do not use any third-party libraries other than those already imported in the given code. 

Note that the goal here is to optimize performance, so feel free to experiment with different approaches such as using shared memory, coalesced memory access patterns, etc. 

Remember to compile the CUDA code when necessary. 

**Important**: Your solution should be completely self-contained within the provided code blocks. This means that all necessary imports, function definitions, and class definitions should be included within the code blocks. Make sure there are no external dependencies beyond what is provided.