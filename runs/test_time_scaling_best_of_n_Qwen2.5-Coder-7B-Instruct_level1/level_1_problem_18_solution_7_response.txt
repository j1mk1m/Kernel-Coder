Please note that I am asking for a full implementation of the new architecture, including all necessary imports and setup, not just snippets of code.