Please note that while it's okay to use libraries like `torch.cuda` for low-level operations, it's generally preferred to use PyTorch's high-level APIs where possible. However, for the purpose of this exercise, feel free to implement any solution using low-level CUDA operations directly if necessary.