The output should look something like this:

```python
import torch
import torch.nn as nn
import torch.nn.functional as F
from torch.utils.cpp_extension import load_inline

...

class ModelNew(nn.Module):
    ...

    def forward(self, x: torch.Tensor) -> torch.Tensor:
        ...
```

Please note that you need to provide a working implementation of the `ModelNew` class using custom CUDA kernels where appropriate. Make sure to handle edge cases and ensure the functionality remains consistent with the original `Model`.