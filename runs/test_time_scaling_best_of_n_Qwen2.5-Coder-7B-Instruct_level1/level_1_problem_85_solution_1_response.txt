Your solution should be optimized for performance on NVIDIA GPUs. Use efficient memory access patterns and parallelize the computation wherever possible. Consider using techniques such as shared memory, coalesced memory accesses, and vectorized operations to achieve maximum throughput. 

Please provide comments explaining your choices and optimizations in the code. ```python
 ```