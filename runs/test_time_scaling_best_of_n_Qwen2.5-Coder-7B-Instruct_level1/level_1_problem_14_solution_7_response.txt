Please note that you should aim for significant performance improvements over the original implementation. If possible, try to implement fused operations or more efficient algorithms. For instance, you could use a blocked matrix multiplication algorithm for better cache utilization or implement an optimized version of the `triu` function.