Please do not use any third-party libraries such as apex or PyTorch extensions that are not part of the official PyTorch library. Also, avoid using any pre-built CUDA kernels provided by PyTorch unless necessary. Implement everything from scratch. 

The goal is to achieve maximum performance improvements over the original architecture by replacing suitable operations with custom CUDA kernels. Be creative and think about efficient memory access patterns, parallelism, and algorithmic optimizations. 

Please provide detailed explanations for any decisions you made during the optimization process.