The resulting code should be efficient, taking advantage of GPU acceleration where possible. Your implementation should be able to handle large batch sizes efficiently. ```python
 ```