Please note that the optimization should be done using custom CUDA kernels, and the goal is to achieve faster execution times compared to the original PyTorch implementation. Feel free to use any PyTorch functionalities, but the core operations should be implemented using CUDA.