Your solution should include at least one custom CUDA kernel, and it should be used to replace a PyTorch operator in the given architecture. Feel free to optimize further by combining multiple operations into a single kernel or using more efficient algorithms. Justify your choices for the custom CUDA kernels you've implemented.