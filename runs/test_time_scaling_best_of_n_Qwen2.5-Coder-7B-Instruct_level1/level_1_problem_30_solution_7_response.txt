Please follow the guidelines provided in the prompt and optimize the architecture as much as possible using custom CUDA kernels. You may combine multiple operations into a single kernel or use alternative algorithms to achieve better performance. Be creative and think outside the box!