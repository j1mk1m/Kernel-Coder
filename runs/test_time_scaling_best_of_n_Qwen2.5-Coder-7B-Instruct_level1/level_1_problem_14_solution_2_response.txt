Make sure to use proper formatting for the code blocks. 

Please provide a detailed explanation of any decisions made regarding which operators to replace with custom CUDA kernels, including any performance optimizations or algorithmic improvements you've implemented.