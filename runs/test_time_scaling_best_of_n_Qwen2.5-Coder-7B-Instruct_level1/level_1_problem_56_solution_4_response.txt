Please note that you should only use PyTorch and CUDA functionalities for implementing the custom CUDA kernels. Avoid using external libraries unless necessary.