Please follow the guidelines provided above and optimize the architecture using custom CUDA kernels where appropriate. Feel free to experiment with different approaches such as operator fusion or algorithmic changes.