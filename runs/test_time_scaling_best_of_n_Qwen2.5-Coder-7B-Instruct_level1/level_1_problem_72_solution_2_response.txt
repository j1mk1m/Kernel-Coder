Your solution should be optimal for both throughput and latency, considering both hardware and software optimizations. Feel free to use any optimization techniques such as operator fusion, algorithmic changes, or memory access patterns that can improve performance. You are encouraged to experiment with different approaches and compare their performance. 

Please provide a brief explanation of your optimization choices and how they contribute to improved performance.