Please ensure that you use appropriate CUDA memory management techniques and follow best practices for performance optimization. Your solution should be efficient in terms of both time and space complexity. ```