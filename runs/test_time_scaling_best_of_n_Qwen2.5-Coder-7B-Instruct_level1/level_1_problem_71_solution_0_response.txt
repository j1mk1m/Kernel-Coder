Please ensure that the new architecture maintains the same functionality as the original architecture but is faster due to the use of custom CUDA kernels.