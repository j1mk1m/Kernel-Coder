Please provide the full code for the new architecture including any necessary imports and function definitions. Make sure that the new architecture can be used interchangeably with the original architecture without requiring any modifications to the rest of the codebase.