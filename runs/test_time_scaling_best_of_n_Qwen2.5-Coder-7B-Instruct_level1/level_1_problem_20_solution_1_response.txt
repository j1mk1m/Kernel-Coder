Your solution should aim to optimize both memory usage and computational efficiency, while maintaining the functionality of the original model. Feel free to introduce additional helper functions or classes if necessary. Make sure to include any necessary imports at the beginning of your code blocks.