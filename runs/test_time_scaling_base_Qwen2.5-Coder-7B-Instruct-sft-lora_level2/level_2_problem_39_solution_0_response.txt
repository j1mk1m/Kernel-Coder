Please provide the full implementation of `ModelNew`, including any necessary imports and helper functions. Make sure the architecture still works correctly after optimization.

Note: Feel free to use any additional libraries or dependencies you find necessary to implement the custom CUDA operators.