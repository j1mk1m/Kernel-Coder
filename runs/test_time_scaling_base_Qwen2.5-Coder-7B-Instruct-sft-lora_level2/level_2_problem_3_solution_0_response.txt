Note: Feel free to modify any part of the architecture, including changing the order of operations, adding new layers, or replacing existing ones with custom CUDA operators. The goal is to optimize performance using custom CUDA kernels.

### Requirements:

- The custom CUDA kernels should be implemented in C++ and CUDA.
- The kernels should be loaded into PyTorch using `torch.utils.cpp_extension.load_inline`.
- The architecture should maintain the same functionality as the original Model class.
- The optimized ModelNew class should be able to handle inputs with different shapes and batch sizes.
- The optimized ModelNew class should use the custom CUDA kernels wherever possible to achieve speedup.
```