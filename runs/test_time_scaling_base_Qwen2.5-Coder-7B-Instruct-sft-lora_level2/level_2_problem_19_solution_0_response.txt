Your solution should include a brief description of the optimizations made and how they improve performance.

**NOTE:** If you decide to replace any of the PyTorch operators with custom CUDA kernels, ensure that the replacement maintains numerical stability and correctness. For instance, replacing batch normalization with a custom implementation should be done carefully to avoid issues such as vanishing/exploding gradients.