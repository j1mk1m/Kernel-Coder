Please note that the goal is to achieve better performance through custom CUDA kernels, so feel free to optimize both the kernel implementation and the overall architecture design if necessary. Make sure to test your solution thoroughly to ensure it works correctly.