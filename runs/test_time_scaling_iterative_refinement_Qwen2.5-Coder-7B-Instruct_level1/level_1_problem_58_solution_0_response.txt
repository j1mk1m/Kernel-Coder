Please ensure that the solution is as efficient as possible while maintaining readability. Feel free to add any additional helper functions or classes as needed. Make sure to comment your code where necessary.