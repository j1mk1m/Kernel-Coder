Please provide the final version of the code after all improvements.
```