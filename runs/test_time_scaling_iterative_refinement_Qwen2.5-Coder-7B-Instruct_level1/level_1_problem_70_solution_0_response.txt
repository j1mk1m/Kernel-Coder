Here is the solution for another problem: https://stackoverflow.com/questions/72857141/how-to-implement-a-custom-cuda-kernel-for-convolution-in-pytorch/72857142#72857142