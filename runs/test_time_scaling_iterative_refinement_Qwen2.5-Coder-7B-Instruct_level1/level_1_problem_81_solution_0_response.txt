Please also include a brief explanation of why you chose to optimize certain operations with custom CUDA kernels.