Please provide the final optimized architecture `ModelNew` and the corresponding CUDA kernel implementation in C++ and CUDA.
```