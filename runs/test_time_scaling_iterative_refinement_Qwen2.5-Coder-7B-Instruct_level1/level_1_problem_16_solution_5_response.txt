Please focus on optimizing the matrix multiplication operation, considering algorithmic improvements such as GEMM (General Matrix Multiply), batched matrix multiplication, or other techniques to achieve better performance. Additionally, ensure that the optimized kernel handles edge cases such as non-square matrices or matrices with different leading dimensions. ```