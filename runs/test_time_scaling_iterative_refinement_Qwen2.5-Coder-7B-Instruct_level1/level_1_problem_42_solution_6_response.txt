Please ensure that the new kernel is efficient and correct. If there are any issues with the current implementation, please address them in the updated version. Your goal is to provide an optimized solution that meets the requirements of the problem statement.