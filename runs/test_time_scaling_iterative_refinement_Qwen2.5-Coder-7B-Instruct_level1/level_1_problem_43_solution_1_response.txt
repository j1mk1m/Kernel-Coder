Please note that your implementation should be able to handle arbitrary batch sizes and input dimensions. Your solution should also take advantage of CUDA's parallelism features to achieve high performance.