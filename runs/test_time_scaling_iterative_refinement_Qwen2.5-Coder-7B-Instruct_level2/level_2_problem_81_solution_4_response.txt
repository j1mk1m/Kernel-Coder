Please ensure that the final version works correctly and efficiently compared to the original implementation. Make sure to handle all edge cases appropriately.

Let's see how we can improve upon our previous attempt by addressing any issues encountered during evaluation.
```