Please provide the corrected and improved version of the code.