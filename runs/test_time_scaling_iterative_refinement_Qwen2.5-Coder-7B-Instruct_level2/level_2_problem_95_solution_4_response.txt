Please include comments in your code explaining what each part does, especially parts where you deviated from the original implementation.