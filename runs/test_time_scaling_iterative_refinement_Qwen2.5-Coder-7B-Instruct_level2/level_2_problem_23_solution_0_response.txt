Please provide the full implementation including the necessary imports and any other helper functions needed. Make sure the new model produces the same output as the original model.
 ```