Please provide the final version of your code after optimization.