Please provide the updated code after debugging and improvements.
```