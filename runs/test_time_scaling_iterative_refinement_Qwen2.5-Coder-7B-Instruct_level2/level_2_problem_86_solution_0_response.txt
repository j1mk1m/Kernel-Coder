```python
class ModelNew(nn.Module):
    ...
```

Please provide the entire implementation including any necessary imports and helper functions.

Here is a hint to help you start:

```python
import torch
import torch.nn as nn
import torch.nn.functional as F
from torch.utils.cpp_extension import load_inline
```

You can use the `load_inline` function from PyTorch to compile your custom CUDA kernels. Remember to define your CUDA kernels using the appropriate CUDA syntax and include them in your source code. Then, you can call these kernels from within your `ModelNew` class. Be sure to handle memory allocation and deallocation correctly when working with CUDA tensors.