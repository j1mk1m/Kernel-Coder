Please ensure that the new implementation is thoroughly tested and verified to match the behavior of the original model.