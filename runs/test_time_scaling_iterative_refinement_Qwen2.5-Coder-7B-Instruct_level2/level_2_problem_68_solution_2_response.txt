Please ensure your code is correct and efficient before submission. If there are any errors or issues, please debug them and provide the corrected code. Ensure the new architecture achieves the same functionality as the original one but with improved performance through custom CUDA kernels.