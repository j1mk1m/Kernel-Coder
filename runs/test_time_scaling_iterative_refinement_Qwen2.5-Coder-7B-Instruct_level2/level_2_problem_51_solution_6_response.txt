Please provide the final implementation that passes all tests.
```