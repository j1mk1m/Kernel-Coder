Please ensure that your implementation is correct and produces the same output as the original architecture when run on the same inputs. Additionally, aim to optimize both the computational complexity and memory usage where possible.