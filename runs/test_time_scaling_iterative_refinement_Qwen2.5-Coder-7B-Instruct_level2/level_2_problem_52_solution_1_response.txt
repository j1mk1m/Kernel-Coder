Please provide a detailed explanation of your approach and any challenges faced during the optimization process. Include any performance improvements observed through the use of custom CUDA kernels.