Please note that I am looking for a solution that addresses both correctness and performance. If your previous attempt was incorrect, please provide the corrected version along with an explanation of what was wrong and how it has been fixed. If your previous attempt was correct but inefficient, please provide an improved version along with an explanation of the changes made to improve performance.