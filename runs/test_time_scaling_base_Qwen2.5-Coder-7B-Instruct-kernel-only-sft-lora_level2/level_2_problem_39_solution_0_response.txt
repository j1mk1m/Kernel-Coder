The goal is to maximize performance, so feel free to use any optimization technique such as operator fusion, algorithmic changes, or parallelism. For simplicity, assume all inputs fit into GPU memory.