Please note that the goal is to optimize the performance of the model using CUDA kernels where appropriate, but also maintaining readability and maintainability of the code. ```python
 ```