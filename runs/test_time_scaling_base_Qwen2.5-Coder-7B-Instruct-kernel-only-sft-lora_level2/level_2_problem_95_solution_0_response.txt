The optimization should be done considering the following criteria:

- **Speedup**: Optimize for speedup using custom CUDA kernels wherever possible.
- **Memory Efficiency**: Minimize memory usage without sacrificing performance.
- **Algorithmic Improvements**: Consider alternative algorithms that could improve efficiency.

Please provide the optimized `ModelNew` class along with any necessary helper functions or classes. Ensure that the functionality remains the same as the original `Model`.