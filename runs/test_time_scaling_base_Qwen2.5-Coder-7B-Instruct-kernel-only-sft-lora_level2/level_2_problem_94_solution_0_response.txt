The goal is to maximize performance by replacing appropriate operators with custom CUDA kernels. Feel free to use any PyTorch or CUDA libraries available. Your solution should be optimized for GPU execution. 

Please include comments explaining your choices and optimizations. ```python
 ```