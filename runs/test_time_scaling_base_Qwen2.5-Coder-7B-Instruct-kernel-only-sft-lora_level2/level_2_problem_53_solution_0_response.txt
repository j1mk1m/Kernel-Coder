Note: You can use any CUDA features you wish, but be mindful of memory bandwidth limitations and ensure efficient memory usage. For simplicity, assume all inputs fit in GPU memory.

```