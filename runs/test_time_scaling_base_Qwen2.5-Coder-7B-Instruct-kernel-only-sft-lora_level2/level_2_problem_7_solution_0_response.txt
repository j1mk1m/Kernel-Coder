Please do not use any libraries other than torch and torch.nn. Also, please ensure that the custom CUDA operators are implemented correctly and efficiently. 

The goal is to maximize the performance of the model by replacing PyTorch operators with custom CUDA kernels where appropriate.

```