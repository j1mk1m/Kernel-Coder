This completes the optimization of the architecture using custom CUDA operators.