Please provide the full code for `ModelNew`, including any necessary imports and helper functions. Ensure that the architecture maintains the same functionality as the original `Model`.