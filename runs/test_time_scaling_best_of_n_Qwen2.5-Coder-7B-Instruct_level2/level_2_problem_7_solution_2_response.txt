Please note that the goal is to achieve maximum speedup through the use of custom CUDA kernels. Therefore, it is acceptable to sacrifice readability and complexity for performance gains.

```