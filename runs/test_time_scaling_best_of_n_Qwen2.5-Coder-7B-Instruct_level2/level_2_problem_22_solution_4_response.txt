The code should be optimized using any method described in the prompt, including but not limited to replacing PyTorch operators with custom CUDA kernels, operator fusion, algorithmic changes, etc.

Please ensure the custom CUDA kernels are well-documented and the overall performance is improved compared to the original PyTorch implementation.

```