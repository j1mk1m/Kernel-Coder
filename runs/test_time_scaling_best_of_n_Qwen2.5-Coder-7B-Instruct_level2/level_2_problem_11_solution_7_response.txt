Your implementation should include at least one custom CUDA kernel, but feel free to add more if needed. Feel free to combine multiple operators into a single kernel if it would be beneficial.

Please note that the goal is to achieve speedups through the use of custom CUDA kernels, so focus on optimizing critical parts of the architecture.