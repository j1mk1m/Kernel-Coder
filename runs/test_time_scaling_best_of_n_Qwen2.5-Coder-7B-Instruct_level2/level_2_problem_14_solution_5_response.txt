Your code should include the definition of the new model `ModelNew` along with any necessary imports, function definitions, and other helper code. The new model should use custom CUDA operators wherever possible to achieve performance improvements over the original `Model`. Feel free to combine multiple operations into a single kernel, change algorithms, or otherwise optimize the implementation. The goal is to maximize performance while maintaining correctness.