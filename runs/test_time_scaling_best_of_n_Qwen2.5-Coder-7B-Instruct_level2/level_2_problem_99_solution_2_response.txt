Your solution should include all necessary imports, class definition, and any additional helper functions needed. Make sure the new architecture can be used interchangeably with the original architecture in terms of inputs and outputs.