Note: Feel free to add any necessary imports and helper functions, but ensure the final architecture can be instantiated and run without errors.

```