Please provide the final code after optimization.