Please note that the goal here is not just to optimize performance but also to demonstrate advanced usage of PyTorch and CUDA. Therefore, feel free to use any advanced techniques such as operator fusion, algorithmic optimizations, or other creative solutions. 

For simplicity, assume that all input tensors fit into GPU memory.
```










































s
