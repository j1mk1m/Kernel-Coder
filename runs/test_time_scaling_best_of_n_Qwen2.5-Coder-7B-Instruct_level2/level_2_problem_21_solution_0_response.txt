Make sure to use appropriate data types and memory management practices. Your solution should aim for high performance while maintaining correctness.

Please note that the goal is to achieve the highest possible performance improvement over the original PyTorch implementation. Feel free to experiment with different optimization techniques such as operator fusion, algorithmic changes, or any other method that can lead to better performance. However, ensure that the final implementation remains correct and produces the same results as the original PyTorch model.