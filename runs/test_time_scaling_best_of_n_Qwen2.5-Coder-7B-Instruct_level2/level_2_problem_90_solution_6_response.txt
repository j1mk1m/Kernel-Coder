Note: The goal is to optimize the performance of the model by replacing PyTorch operators with custom CUDA kernels where appropriate. Be creative in how you approach this task, considering algorithmic changes, operator fusion, and other optimization techniques.

```