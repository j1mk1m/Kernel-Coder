You should use the `load_inline` function from PyTorch extensions to compile the CUDA kernels. Make sure to include all necessary imports and define any helper functions if needed. Be creative with your optimizations! Feel free to combine operators, use fused algorithms, or implement more efficient versions of existing operations.

**Note:** The solution must be self-contained and should not rely on external libraries beyond what is provided in the PyTorch ecosystem.