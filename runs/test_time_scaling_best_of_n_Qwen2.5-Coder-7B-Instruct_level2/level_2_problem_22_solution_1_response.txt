Please note that your solution should be efficient and should ideally leverage CUDA parallelism wherever possible. You may also use other libraries such as PyTorch C++ API, but avoid using NumPy or any other CPU-based libraries in the CUDA kernels. Also, ensure that the overall structure and behavior of the original model remain intact.