    Note: Your solution should focus on optimizing performance by replacing PyTorch operators with custom CUDA kernels where appropriate. You should aim to reduce the number of GPU memory transfers and increase parallelism wherever possible.

 ```