Please ensure that your implementation makes efficient use of GPU resources, such as parallelism, memory access patterns, and data locality. Feel free to use any techniques from the PyTorch documentation or other sources to optimize performance. Your solution should be scalable and maintainable.

Note: This problem requires knowledge of both PyTorch and CUDA programming. It also requires understanding of how to implement and use custom CUDA kernels within PyTorch. It is a challenging problem that will test your ability to apply advanced concepts in machine learning and computer science. Good luck!