Please note that the goal here is to optimize the performance of the model by replacing certain operations with custom CUDA kernels. Feel free to experiment with different combinations of operations and algorithms to achieve the best performance.

The model should still produce the same output when run with the provided inputs. Only the internal implementation details should be changed to use custom CUDA kernels where appropriate. ```