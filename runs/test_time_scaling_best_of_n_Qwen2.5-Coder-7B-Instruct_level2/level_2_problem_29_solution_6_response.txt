    Make sure to include all necessary imports and any other code needed to compile and run the model. 

    For simplicity, you can assume that the input tensor has the same shape across all operations. 

    Feel free to optimize the model however you see fit, but remember to keep it simple and understandable. 

    Your goal is to achieve the highest possible performance gain while maintaining readability and maintainability.