Please note that the optimization should be done considering the performance improvements possible due to the use of custom CUDA kernels, such as parallelism, memory access patterns, and other optimizations specific to GPU architectures.