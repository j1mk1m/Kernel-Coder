Your solution should aim to optimize performance as much as possible, considering both the hardware capabilities and the specific operations involved in the original architecture.

Please note that you can use any libraries available in PyTorch and CUDA to help with the implementation of these custom operators. However, the final solution must be fully self-contained within the provided code blocks, without relying on external files or directories.