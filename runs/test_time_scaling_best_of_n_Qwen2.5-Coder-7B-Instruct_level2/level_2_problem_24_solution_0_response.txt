Please note that the goal here is to optimize performance using custom CUDA kernels, so the resulting code should be faster than the original PyTorch implementation. ```