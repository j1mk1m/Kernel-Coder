Make sure to use appropriate CUDA best practices such as grid-stride looping and shared memory where applicable. Your solution should aim to achieve significant performance improvements over the original PyTorch implementation. If possible, provide an explanation for the optimizations you made and why they are beneficial.