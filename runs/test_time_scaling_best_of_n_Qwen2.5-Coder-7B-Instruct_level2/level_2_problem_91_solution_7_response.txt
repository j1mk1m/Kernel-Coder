Please note that you can use any libraries such as `torch`, `numpy`, etc., but do not include any external dependencies beyond what is necessary. Your solution should be completely self-contained.

Also, please provide a brief explanation of your optimization choices in the comments within the code.