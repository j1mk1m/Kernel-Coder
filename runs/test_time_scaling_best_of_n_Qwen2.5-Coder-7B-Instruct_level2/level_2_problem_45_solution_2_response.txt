Here are the requirements:

- Replace at least one operator with a custom CUDA kernel.
- Combine multiple operators where possible to reduce the number of operations and improve performance.
- Use efficient algorithms wherever applicable.

Please provide the optimized code in python using torch.nn and torch.cuda functionalities. Ensure that the functionality remains the same as the original model.