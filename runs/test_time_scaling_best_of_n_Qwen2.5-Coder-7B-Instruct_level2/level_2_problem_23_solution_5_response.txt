Note: You can use any libraries from PyTorch, NumPy, etc., but you cannot use any existing CUDA/C++ implementations of these operations. You must implement them yourself using CUDA.