Note: You can use any PyTorch operations, but please avoid using built-in CUDA operations directly unless necessary. Your goal is to optimize the performance of the model through custom CUDA kernels.

---

 ```