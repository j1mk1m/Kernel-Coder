Please provide the full code including the ModelNew class definition, the CUDA kernel definitions, and any necessary imports. Make sure to include all necessary CUDA headers and libraries.

```python
import torch
import torch.nn as nn
import torch.nn.functional as F
from torch.utils.cpp_extension import load_inline

# CUDA kernel definitions go here

# Custom CUDA function definitions go here

class ModelNew(nn.Module):
    # Your implementation goes here
    pass

```