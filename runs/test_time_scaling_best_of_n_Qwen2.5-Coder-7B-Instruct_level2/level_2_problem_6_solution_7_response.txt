Make sure your solution includes at least one custom CUDA kernel replacement, preferably more. Feel free to experiment with different combinations of operator replacements and optimizations. Your goal is to achieve the highest possible performance gain while maintaining functionality.

Your final output should be runnable and include all necessary imports, function definitions, and class definitions. Ensure that the new architecture can handle the same inputs as the original architecture.