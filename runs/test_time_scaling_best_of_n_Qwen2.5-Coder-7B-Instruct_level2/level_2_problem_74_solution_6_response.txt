Note: Feel free to use any PyTorch functionality but do not use any pre-implemented CUDA kernels in PyTorch. Your implementation should be entirely custom CUDA kernels. You can include helper CUDA C++ code within the same file as the kernel definition. However, please ensure that the final implementation is self-contained and does not rely on external libraries beyond what is provided by PyTorch and standard C++.