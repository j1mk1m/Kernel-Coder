The goal is to optimize the architecture as much as possible using custom CUDA operators, while maintaining the same functionality. Feel free to add any necessary imports at the beginning of your code.

Please provide a detailed explanation of your optimizations and why they were chosen.