Please include all necessary imports and any additional helper functions or classes that are needed to compile and run the new architecture.

Note: This problem does not require any optimization related to memory access patterns or data parallelism beyond what is possible using custom CUDA kernels. The focus should be on optimizing the computation itself through the use of efficient algorithms or custom operators.
```































