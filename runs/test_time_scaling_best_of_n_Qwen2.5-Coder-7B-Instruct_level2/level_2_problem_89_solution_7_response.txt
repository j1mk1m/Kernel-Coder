Note: Feel free to optimize any part of the architecture. Consider operator fusion opportunities, algorithmic changes, or using different algorithms altogether. The goal is to achieve maximum performance while maintaining correctness.