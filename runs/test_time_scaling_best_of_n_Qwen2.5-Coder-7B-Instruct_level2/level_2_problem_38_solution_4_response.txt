Please also include comments in the code explaining why certain optimizations were made.