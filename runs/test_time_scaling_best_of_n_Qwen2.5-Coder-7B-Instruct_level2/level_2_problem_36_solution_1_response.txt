The solution should be a single codeblock containing the full implementation of ModelNew including imports and any other necessary helper functions.

Note: Feel free to experiment with different operators and techniques to achieve the best performance. Consider using techniques such as operator fusion, algorithmic optimizations, or even changing the underlying data structures to improve performance. Your goal is to create a version of Model that runs faster than the original while maintaining the same functionality.